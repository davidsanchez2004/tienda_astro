---
import AdminLayout from '../../layouts/AdminLayout.astro';
import AdminLoginForm from '../../components/admin/AdminLoginForm';

// Si ya está autenticado, redirigir al dashboard
const adminToken = Astro.cookies.get('admin_token');
if (adminToken?.value) {
  try {
    const payload = JSON.parse(Buffer.from(adminToken.value, 'base64').toString());
    if (payload.exp && payload.exp > Date.now()) {
      // Token válido, redirigir al dashboard
      return Astro.redirect('/admin/dashboard');
    }
  } catch (e) {
    // Token inválido, mostrar login
  }
}
---

<AdminLayout title="Admin - Iniciar Sesión">
  <div class="min-h-screen bg-gradient-to-br from-arena-pale to-white flex items-center justify-center py-12 px-4">
    <div class="max-w-md w-full bg-white rounded-lg shadow-lg p-8">
      <h1 class="text-3xl font-bold text-arena text-center mb-2">BY ARENA</h1>
      <p class="text-gray-600 text-center mb-8">Panel de Administración</p>
      
      <AdminLoginForm client:load />
    </div>
  </div>
</AdminLayout>
